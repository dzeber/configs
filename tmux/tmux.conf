# remap prefix to Ctrl-Space
unbind-key C-Space
set-option -g prefix C-Space
bind-key C-Space send-prefix

# colour terminal
# (included in tmux-sensible)
#set-option -g default-terminal "screen-256color"
# override so as to make colours work with Vim
# https://github.com/tmux/tmux/issues/1246
# https://github.com/tmux/tmux/issues/622
set-option -ga terminal-overrides ",screen-256color:Tc"

# longer history
set-option -g history-limit 10000

# number windows from 1
set-option -g base-index 1
set-option -g pane-base-index 1
# Renumber the windows when one is closed
set-option -g renumber-windows on

# enable the mouse
set-option -g mouse on

# open new windows in current dir
bind-key c new-window -c "#{pane_current_path}"
bind-key '"' split-window -c "#{pane_current_path}"
bind-key % split-window -h -c "#{pane_current_path}"

# reload config
# included in tmux-sensible
#bind-key R source-file ~/.tmux.conf \; display-message "Config reloaded!"

#------------------------------------------------------------------------------

# Status bar
# ---------

set-option -g status-style "fg=colour228,bg=colour240" 
set-option -g status-left-style "bold"
# Allow more space for the session name
set-option -g status-left-length 50
set-option -g status-right-style "bold"
# Modify the right part of the status bar:
# - remove date and time on Mac
# - indicate when prefix key has been pressed
set-option -g status-right "\
#{?client_prefix,#[bg=colour63]<Prefix>#[default]  ,}\
#{?window_bigger,[#{window_offset_x}#,#{window_offset_y}] ,}\
#{?#{m:Darwin,#(uname)},,%H:%M %d-%b-%y}\
"

# Window list styling
set-option -g window-status-current-style "bold"
set-option -g window-status-last-style "underscore"
set-option -g window-status-separator " | "

# Use a second status bar row to display pane information:
# - highlight active pane
# - indicate panes in a mode and/or zoomed
# - if the pane has a non-default title (ie not the hostname),
#   show that, otherwise show the current command
set-option -g status-format[1] "\
#[align=centre]#{P:\
#{?#{==:#P,1},, | }\
#{?pane_active,#[bold],}\
#{?pane_in_mode,#[bg=colour69],}\
#{?#{&&:#{window_zoomed_flag},#{pane_active}},#[bg=colour69],}\
#{?pane_marked,#[underscore],}\
#{pane_index}:\
#{?#{!=:#{pane_title},#H},#{pane_title},#{pane_current_command}}\
#{?window_zoomed_flag, (Z),}\
#{?pane_in_mode, (#{pane_mode}),}\
#[default]}\
"
set-option -g status  2


# Panes
# -----

set-option -g pane-active-border-style "fg=white"
set-option -g pane-border-style "fg=colour240"


#------------------------------------------------------------------------------

# Plugins
#--------

set-option -g @plugin "tmux-plugins/tpm"
set-option -g @plugin "tmux-plugins/tmux-sensible"
#set-option -g @plugin "tmux-plugins/tmux-sidebar"
# Persistent sessions
set-option -g @plugin "tmux-plugins/tmux-resurrect"
set-option -g @plugin "tmux-plugins/tmux-continuum"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b "~/.tmux/plugins/tpm/tpm"

